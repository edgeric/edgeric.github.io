<!DOCTYPE html>

<html :class="{'dark': darkMode === 'dark' || (darkMode === 'system' &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)}" class="scroll-smooth" data-content_root="./" lang="en" x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }" x-init="$watch('darkMode', val =&gt; localStorage.setItem('darkMode', val))">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="white" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="black" media="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>EdgeRIC tutorial | EdgeRIC v0.1 documentation</title>
<meta content="EdgeRIC tutorial | EdgeRIC v0.1 documentation" property="og:title"/>
<meta content="EdgeRIC tutorial | EdgeRIC v0.1 documentation" name="twitter:title"/>
<link href="_static/pygments.css?v=e72c8e07" rel="stylesheet" type="text/css"/>
<link href="_static/theme.css?v=42baaae4" rel="stylesheet" type="text/css"/>
<link href="_static/custom.css?v=162f35ca" rel="stylesheet" type="text/css"/>
<link href="search.html" rel="search" title="Search"/>
<link href="genindex.html" rel="index" title="Index"/>
<script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false, showScrollTop: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="index.html"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">EdgeRIC v0.1 documentation</span>
</a></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none"><form @keydown.k.window.meta="$refs.search.focus()" action="search.html" class="relative flex items-center group" id="searchbox" method="get">
<input aria-label="Search the docs" class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" id="search-input" name="q" placeholder="Search ..." type="search" x-ref="search"/>
<kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
<span class="text-xs">⌘</span>
    K
  </kbd>
</form>
</div>
<nav class="flex items-center space-x-1">
<button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'" aria-label="Color theme switcher" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="!justify-start text-sm md:!hidden bg-background" href="index.html"><span class="font-bold text-clip whitespace-nowrap">EdgeRIC v0.1 documentation</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
<div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Cellular Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html#tiny-twin-emulation-module">Tiny-twin: Emulation module</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html#over-the-air-setup">Over The Air Setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Events</span></p>
<ul>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="oaic-workshop-2024.html">OAIC-EdgeRIC Workshop ‘24<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="edgeric-workshop-tutorial.html">EdgeRIC tutorial</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="srsran-2024-workshop.html">srsRAN Workshop ‘24</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EdgeRIC Architecture</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="edgeric-architecture.html">RT-E2 interface (Real time E2 interface)</a></li>
<li class="toctree-l1"><a class="reference internal" href="edgeric-architecture.html#rt-e2-report-message">RT-E2 Report Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="edgeric-architecture.html#rt-e2-policy-message">RT-E2 Policy Message</a></li>
<li class="toctree-l1"><a class="reference internal" href="edgeric-architecture.html#redis-database">REDIS database</a></li>
<li class="toctree-l1"><a class="reference internal" href="edgeric-architecture.html#apps-edgeric-microservices">μApps - EdgeRIC microservices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EdgeRIC tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="edgeric.html">EdgeRIC main paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="windex.html">Windex</a></li>
<li class="toctree-l1"><a class="reference internal" href="beamarmor.html">BeamArmor</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparc.html">SPARC</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Dataset</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Channel Traces</a></li>
</ul>
</nav>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="index.html">
<span class="hidden md:inline">EdgeRIC v0.1 documentation</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">/</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">EdgeRIC tutorial</span>
</nav>
<div id="content" role="main">
<section id="edgeric-tutorial">
<h1>EdgeRIC tutorial</h1>
<div class="line-block">
<div class="line">Website: <a class="reference external" href="https://edgeric.github.io/">https://edgeric.github.io/</a></div>
<div class="line">Tutorial: <a class="reference external" href="https://edgeric.github.io/edgeric-workshop-tutorial.html">https://edgeric.github.io/edgeric-workshop-tutorial.html</a></div>
</div>
<p>In this tutorial, we will go over the EdgeRIC architecture and installation of the srsRAN network facilitated with EdgeRIC hooks. We also provide a containerized version of our codebase. We will discuss how to write μApps. As an example, we will run a real-time MAC scheduler μApp that assigns scheduling decisions per UE for each TTI. We will look at multiple scheduling algorithms with this μApp to demonstrate the system behavior: <code class="docutils literal notranslate"><span class="pre">Max</span> <span class="pre">Weight</span></code>, <code class="docutils literal notranslate"><span class="pre">Max</span> <span class="pre">CQI</span></code>, <code class="docutils literal notranslate"><span class="pre">Proportional</span> <span class="pre">Fairness</span></code>, <code class="docutils literal notranslate"><span class="pre">Round</span> <span class="pre">Robin</span></code>, and <code class="docutils literal notranslate"><span class="pre">an</span> <span class="pre">RL</span> <span class="pre">based</span> <span class="pre">scheduler</span></code>.</p>
<section id="app-demo-mac-scheduling">
<h2>μApp demo: MAC scheduling</h2>
<p>This μApp offers scheduling decisions to the RAN at the granularity of one TTI (~1ms). It adopts a weight-based approach for its decision. The weight of a UE corresponds to its relative priority to be scheduled given the current state of the system. We list the metrics used by this μApp below:</p>
<p>Metrics: <code class="docutils literal notranslate"><span class="pre">ue_data[rnti]['Tx'],</span> <span class="pre">ue_data[rnti]['CQI'],</span> <span class="pre">ue_data[rnti]['BL']</span></code> for each UE.</p>
<p>Actions Sent: <code class="docutils literal notranslate"><span class="pre">weight_{i}</span></code> which corresponds to the weight of each UE <code class="docutils literal notranslate"><span class="pre">i</span></code></p>
<p>RT-E2 Policy Format for this μApp: <code class="docutils literal notranslate"><span class="pre">RNTI_{i},</span> <span class="pre">weight_{i}</span></code> where <code class="docutils literal notranslate"><span class="pre">i</span></code> corresponds to each UE.</p>
</section>
<section id="training-reinforcement-learning-scheduling-policy">
<h2>Training Reinforcement Learning scheduling Policy</h2>
<p>Here, we train an RL agent with the objective of <strong>total system throughput maximization</strong>. Listed below are the specifications for our training:</p>
<ul class="simple">
<li><p>Algorithm used: Proximal Policy Optimization</p></li>
<li><p>State_space: [BL1,CQI1,BL2,CQI2…..]</p></li>
<li><p>Action_space: <code class="docutils literal notranslate"><span class="pre">[Weight1,Weight2.....]</span></code></p></li>
<li><p>Reward: Total system throughput</p></li>
</ul>
</section>
<section id="install-srsran-supporting-edgeric-hooks">
<h2>Install srsRAN supporting EdgeRIC hooks</h2>
<p>We will be using Option 2 in this tutorial!</p>
<section id="option-1-install-on-your-system">
<h3>Option 1: Install on your system</h3>
<p>You would need Ubuntu 20 to run this repository, with option 2 you can run on any Linux environment.</p>
<section id="dependencies-and-cloning-the-repository">
<h4>Dependencies and cloning the repository</h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="line-2">sudo<span class="w"> </span>apt-get<span class="w"> </span>-y<span class="w"> </span>upgrade
</span><span id="line-3">
</span><span id="line-4">sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>libfftw3-dev<span class="w"> </span>libmbedtls-dev<span class="w"> </span>libsctp-dev<span class="w"> </span>qt5-default<span class="w"> </span>libconfig++-dev<span class="w"> </span>net-tools<span class="w"> </span>nano<span class="w"> </span>libtool<span class="w"> </span>pkg-config<span class="w"> </span>build-essential<span class="w"> </span>autoconf<span class="w"> </span>automake<span class="w"> </span>git<span class="w"> </span>python3<span class="w"> </span>python3-distutils<span class="w"> </span>python3-pip<span class="w"> </span>python3-apt<span class="w"> </span>libzmq3-dev<span class="w"> </span>python3-zmq<span class="w"> </span>software-properties-common
</span><span id="line-5">
</span><span id="line-6">sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="line-7">sudo<span class="w"> </span>add-apt-repository<span class="w"> </span>ppa:gnuradio/gnuradio-releases
</span><span id="line-8">sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="line-9">sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>gnuradio<span class="w"> </span>xterm<span class="w"> </span>python3-gi<span class="w"> </span>gobject-introspection<span class="w"> </span>gir1.2-gtk-3.0<span class="w"> </span>iputils-ping<span class="w"> </span>iproute2<span class="w"> </span>libx11-dev<span class="w"> </span>iperf
</span><span id="line-10">
</span><span id="line-11">sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
</span><span id="line-12">
</span><span id="line-13">sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>gym<span class="w"> </span>pandas<span class="w"> </span>torchvision<span class="w"> </span>tensorboard<span class="w"> </span>redis<span class="w"> </span>debugpy<span class="w"> </span>ray<span class="w"> </span>gymnasium<span class="w"> </span>dm_tree<span class="w"> </span>pyarrow<span class="w"> </span>typer<span class="w"> </span>scikit-image<span class="w"> </span>plotly
</span><span id="line-14">sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span>hydra-core<span class="o">==</span><span class="m">1</span>.1.0
</span><span id="line-15">
</span><span id="line-16">sudo<span class="w"> </span>pip3<span class="w"> </span>uninstall<span class="w"> </span>-y<span class="w"> </span>protobuf
</span><span id="line-17">sudo<span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span><span class="nv">protobuf</span><span class="o">==</span><span class="m">3</span>.20.*
</span><span id="line-18">
</span><span id="line-19">git<span class="w"> </span>clone<span class="w"> </span>https://github.com/ushasigh/EdgeRIC-A-real-time-RIC.git
</span><span id="line-20">git<span class="w"> </span>checkout<span class="w"> </span>oaic-workshop
</span></code></pre></div>
</div>
</section>
<section id="compile-the-protobuf-message-schema">
<h4>Compile the protobuf message schema</h4>
<p>The protobuf schemas are found in <code class="docutils literal notranslate"><span class="pre">srsran-enb/srsenb/protobufs</span></code> for RAN and in <code class="docutils literal notranslate"><span class="pre">edgeric</span></code> for EdgeRIC.</p>
<p><strong>Compile the protobuf format for the RT-E2 agent</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>srsran-enb/srsenb/protobufs
</span><span id="line-2">protoc<span class="w"> </span>--cpp_out<span class="o">=</span>../rtagent<span class="w"> </span>metrics.proto<span class="w"> </span><span class="c1">## RT-E2 Report Message</span>
</span><span id="line-3">protoc<span class="w"> </span>--cpp_out<span class="o">=</span>../rtagent<span class="w"> </span>control_actions.proto<span class="w"> </span><span class="c1">## RT-E2 Policy message</span>
</span><span id="line-4"><span class="nb">cd</span><span class="w"> </span>../../..
</span></code></pre></div>
</div>
<p>The generated <code class="docutils literal notranslate"><span class="pre">metrics.pb.cc</span></code> and <code class="docutils literal notranslate"><span class="pre">control_actions.pb.cc</span></code> are included in this repository, so this step can be skipped.</p>
<p><strong>Compile the protobuf format for EdgeRIC</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>edgeric
</span><span id="line-2">protoc<span class="w"> </span>--python_out<span class="o">=</span>.<span class="w"> </span>metrics.proto<span class="w"> </span><span class="c1">## RT-E2 Report Message</span>
</span><span id="line-3">protoc<span class="w"> </span>--python_out<span class="o">=</span>.<span class="w"> </span>control_actions.proto<span class="w"> </span><span class="c1">## RT-E2 Policy message</span>
</span><span id="line-4"><span class="nb">cd</span><span class="w"> </span>..
</span></code></pre></div>
</div>
<p>The generated <code class="docutils literal notranslate"><span class="pre">metrics_pb2.py</span></code> and <code class="docutils literal notranslate"><span class="pre">control_actions_pb2.py</span></code> are included in this repository, so this step can be skipped.</p>
</section>
<section id="build-the-repository">
<h4>Build the repository</h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">./make-ran.sh
</span></code></pre></div>
</div>
<p>All config files used in this tutorial are provided in <code class="docutils literal notranslate"><span class="pre">.config</span></code>.</p>
</section>
</section>
<section id="option-2-install-the-containerized-version">
<h3>Option 2: Install the containerized version</h3>
<p>We provide the Dockerfile to run this repository inside a container, the bash scripts account for development mode by mounting the docker volume to the local machine.</p>
<img alt="EdgeRIC docker" class="align-center" src="_images/edgeric-docker.png"/>
<p>Let us first download and install the image of the compute environment.</p>
<p><strong>Terminal 0</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">git<span class="w"> </span>clone<span class="w"> </span>https://github.com/ushasigh/EdgeRIC-A-real-time-RIC.git
</span><span id="line-2"><span class="nb">cd</span><span class="w"> </span>EdgeRIC-A-real-time-RIC
</span><span id="line-3">git<span class="w"> </span>checkout<span class="w"> </span>oaic-workshop
</span><span id="line-4">
</span><span id="line-5">sudo<span class="w"> </span>docker<span class="w"> </span>pull<span class="w"> </span>nlpurnhyun/edgeric_base_oaic
</span><span id="line-6">
</span><span id="line-7"><span class="c1"># sudo ./dockerbuild_edgeric_oaic.sh</span>
</span><span id="line-8">
</span><span id="line-9">sudo<span class="w"> </span>./dockerrun_edgeric_oaic.sh<span class="w"> </span>host<span class="w"> </span><span class="m">0</span>
</span></code></pre></div>
</div>
<section id="building-the-srsran-with-edgeric-support">
<h4>Building the srsRAN with EdgeRIC support</h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">./make_ran.sh
</span></code></pre></div>
</div>
<p><strong>Note on Channel Emulation</strong></p>
<p>We use a modified version of the <code class="docutils literal notranslate"><span class="pre">srsue</span></code> codebase to account for channel variation. The channel is abstracted by the CQI (Channel Quality Indicator) - a 5G MAC layer parameter defined to represent the wireless environment.</p>
<img alt="CQI emulation" class="align-center" src="_images/tiny-twin%2B%2B.png"/>
<p>Included in this repository are the CQI trace datasets obtained from an extensive measurement drive. The traces can be found in <code class="docutils literal notranslate"><span class="pre">srsran-ue/cqis</span></code>.</p>
</section>
<section id="how-to-run-the-network">
<h4>How to run the network</h4>
<p><strong>Running in Docker container:</strong></p>
<p>Run the following on every terminal before running the following set of commands.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">sudo<span class="w"> </span>./dockerexec_edgeric_oaic.sh<span class="w"> </span><span class="m">0</span>
</span><span id="line-2"><span class="nb">cd</span><span class="w"> </span>EdgeRIC-A-real-time-RIC
</span></code></pre></div>
</div>
<p><strong>Running natively:</strong> Use <code class="docutils literal notranslate"><span class="pre">sudo</span></code> for running all the commands.</p>
</section>
<section id="setup-the-core-and-srsenb">
<h4>Setup the core and srsenb</h4>
<p><strong>Terminal 1</strong>: Run the GRC broker. We will run a 2UE scenario.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">python3<span class="w"> </span>top_block_2ue_no_gui.py<span class="w"> </span><span class="c1"># OR ./top_block_2ue_23.04MHz.py if you have GUI support</span>
</span></code></pre></div>
</div>
<p>This step is not needed in over-the-air mode.</p>
<p><strong>Terminal 2</strong>: Run the EPC.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">./run_epc.sh
</span></code></pre></div>
</div>
<p><strong>Terminal 3</strong>: Run the enb.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">./run_enb.sh
</span></code></pre></div>
</div>
</section>
<section id="run-the-ues">
<h4>Run the UEs</h4>
<p>First, add the UE namespaces.</p>
<p><strong>Terminal 4:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">ip<span class="w"> </span>netns<span class="w"> </span>add<span class="w"> </span>ue1
</span><span id="line-2">ip<span class="w"> </span>netns<span class="w"> </span>add<span class="w"> </span>ue2
</span></code></pre></div>
</div>
<p>In this repository, we will use the modified <code class="docutils literal notranslate"><span class="pre">srsue</span></code> codebase provided in <code class="docutils literal notranslate"><span class="pre">srsran-ue</span></code>, which provides support to run UE with a specified channel trace collected from real-world experiments. [In our case, the channel is represented by CQI]</p>
<p><strong>Updating the CQI channel trace</strong>: File under concern: <code class="docutils literal notranslate"><span class="pre">srsran-ue/params{1}.txt</span></code> for ue {i}, update line 5 with the desired CQI file, which should be present in folder <code class="docutils literal notranslate"><span class="pre">srsran-ue/cqis</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">File: params1.txt
</span><span id="line-2">2
</span><span id="line-3">1 7
</span><span id="line-4">1
</span><span id="line-5">../cqis/random_1.txt
</span><span id="line-6">60000
</span><span id="line-7"># in line 1 First: period of cqi emulation
</span><span id="line-8"># in line 2 First: minimum of cqi emulation
</span><span id="line-9"># in line 2 Second: of maximum cqi emulation
</span><span id="line-10"># If in line 2 both values are zero, it reads a file to get realistic cqi data.
</span><span id="line-11"># in line 3 First: initial value of cqi emulation
</span><span id="line-12"># in line 4: filename of cqi trace
</span><span id="line-13"># in line 5: number of data
</span></code></pre></div>
</div>
<p><strong>Option 1:</strong> Run automated scripts for 2 UEs:</p>
<p><strong>Terminal 4:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">./run_srsran_2ue.sh
</span></code></pre></div>
</div>
<p>Press <code class="docutils literal notranslate"><span class="pre">t</span></code> to view the UE metrics on the console.</p>
<p><strong>Option 2:</strong> Run the UEs on separate terminals</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>srsran-ue/build
</span></code></pre></div>
</div>
<p>Run UE1:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">sudo<span class="w"> </span>./srsue/src/srsue<span class="w"> </span>../.config/ue1.conf<span class="w"> </span>--rf.device_name<span class="o">=</span>zmq<span class="w"> </span>--rf.device_args<span class="o">=</span><span class="s2">"tx_port=tcp://*:2001,rx_port=tcp://localhost:2000,id=ue,base_srate=23.04e6"</span><span class="w"> </span>--gw.netns<span class="o">=</span>ue1<span class="w"> </span>--params_filename<span class="o">=</span><span class="s2">"../params1.txt"</span>
</span></code></pre></div>
</div>
<p>Run UE2:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">sudo<span class="w"> </span>./srsue/src/srsue2<span class="w"> </span>../.config/ue2.conf<span class="w"> </span>--rf.device_name<span class="o">=</span>zmq<span class="w"> </span>--rf.device_args<span class="o">=</span><span class="s2">"tx_port=tcp://*:2011,rx_port=tcp://localhost:2010,id=ue,base_srate=23.04e6"</span><span class="w"> </span>--gw.netns<span class="o">=</span>ue2<span class="w"> </span>--params_filename<span class="o">=</span><span class="s2">"../params2.txt"</span>
</span></code></pre></div>
</div>
<p>Press <code class="docutils literal notranslate"><span class="pre">t</span></code> to view the UE metrics on the console.</p>
</section>
<section id="known-issue">
<h4>Known Issue</h4>
<p><strong>Make sure you have an immediate UE attach; UEs should not try to reattach</strong>. After every run, a clean build may be necessary; otherwise, UEs may not attach. Run the following inside the container:</p>
<p><strong>Terminal 0</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">./stop_ran.sh
</span><span id="line-2">./make_ran.sh
</span></code></pre></div>
</div>
<p><strong>What does immediate attach look like</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">Attaching UE...
</span><span id="line-2">Closing stdin thread.
</span><span id="line-3">Current sample rate is 1.92 MHz with a base rate of 23.04 MHz (x12 decimation)
</span><span id="line-4">Current sample rate is 1.92 MHz with a base rate of 23.04 MHz (x12 decimation)
</span><span id="line-5">. # of cqis: 60000 done!
</span><span id="line-6">Attaching UE...
</span><span id="line-7">Closing stdin thread.
</span><span id="line-8">Current sample rate is 1.92 MHz with a base rate of 23.04 MHz (x12 decimation)
</span><span id="line-9">Current sample rate is 1.92 MHz with a base rate of 23.04 MHz (x12 decimation)
</span><span id="line-10">.
</span><span id="line-11">
</span><span id="line-12">Found Cell:  Mode=FDD, PCI=1, PRB=25, Ports=1, CP=Normal, CFO=-0.2 KHz
</span><span id="line-13">Found Cell:  Mode=FDD, PCI=1, PRB=25, Ports=1, CP=Normal, CFO=-0.2 KHz
</span><span id="line-14">Current sample rate is 5.76 MHz with a base rate of 23.04 MHz (x4 decimation)
</span><span id="line-15">Current sample rate is 5.76 MHz with a base rate of 23.04 MHz (x4 decimation)
</span><span id="line-16">Current sample rate is 5.76 MHz with a base rate of 23.04 MHz (x4 decimation)
</span><span id="line-17">Current sample rate is 5.76 MHz with a base rate of 23.04 MHz (x4 decimation)
</span><span id="line-18">Found PLMN:  Id=00101, TAC=7
</span><span id="line-19">Found PLMN:  Id=00101, TAC=7
</span><span id="line-20">Random Access Transmission: seq=9, tti=341, ra-rnti=0x2
</span><span id="line-21">Random Access Transmission: seq=20, tti=341, ra-rnti=0x2
</span><span id="line-22">RRC Connected
</span><span id="line-23">Random Access Complete.     c-rnti=0x46, ta=0
</span><span id="line-24">RRC Connected
</span><span id="line-25">Random Access Complete.     c-rnti=0x47, ta=0
</span><span id="line-26">Network attach successful. IP: 172.16.0.2
</span><span id="line-27">Network attach successful. IP: 172.16.0.3
</span><span id="line-28">Software Radio Systems RAN (srsRAN) 5/8/2024 22:38:19 TZ:0
</span><span id="line-29">Software Radio Systems RAN (srsRAN) 5/8/2024 22:38:19 TZ:0
</span></code></pre></div>
</div>
<p>If you do not observe this, please rebuild srsRAN by running <code class="docutils literal notranslate"><span class="pre">./make_ran.sh</span></code>.</p>
</section>
<section id="stream-traffic">
<h4>Stream Traffic:</h4>
<p>The traffic generators are located in the folder <code class="docutils literal notranslate"><span class="pre">/traffic-generator</span></code>.</p>
</section>
<section id="running-downlink-iperf-traffic">
<h4>Running Downlink iperf traffic</h4>
<p><strong>Terminal 5:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>traffic-generator
</span><span id="line-2">./iperf_server_2ues.sh
</span></code></pre></div>
</div>
<p><strong>Terminal 6:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>traffic-generator
</span><span id="line-2"><span class="c1"># ./iperf_client_2ues.sh &lt;rate_ue{i}&gt; &lt;duration&gt;, eg: below</span>
</span><span id="line-3">./iperf_client_2ues.sh<span class="w"> </span>21M<span class="w"> </span>5M<span class="w"> </span><span class="m">10000</span>
</span></code></pre></div>
</div>
</section>
<section id="running-edgeric">
<h4>Running EdgeRIC</h4>
<p><strong>Terminal 7:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>edgeric
</span><span id="line-2">redis-server
</span></code></pre></div>
</div>
</section>
<section id="edgeric-messenger">
<h4>EdgeRIC messenger</h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">edgeric_messenger
</span><span id="line-2">├──<span class="w"> </span>get_metrics_multi<span class="o">()</span><span class="w">  </span><span class="c1"># get_metrics(): receive metrics from RAN, called by all μApps</span>
</span><span id="line-3">│<span class="w">   </span>├──<span class="w"> </span>returns<span class="w"> </span>ue_data<span class="w"> </span>dictionary
</span><span id="line-4">├──<span class="w"> </span>send_scheduling_weight<span class="o">()</span><span class="w"> </span><span class="c1"># send the RT-E2 scheduling policy message to RAN</span>
</span></code></pre></div>
</div>
</section>
<section id="apps-supported-in-this-codebase">
<h4>μApps supported in this codebase</h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">├──<span class="w"> </span>/muApp1<span class="w">           </span><span class="c1"># weight based abstraction of downlink scheduling control</span>
</span><span id="line-2">│<span class="w">   </span>├──<span class="w"> </span>muApp1_run_DL_scheduling.py
</span><span id="line-3">├──<span class="w"> </span>/muApp2<span class="w">           </span><span class="c1"># training an RL agent to compute downlink scheduling policy</span>
</span><span id="line-4"><span class="w">    </span>├──<span class="w"> </span>muApp2_train_RL_DL_scheduling.py
</span><span id="line-5">├──<span class="w"> </span>/muApp3<span class="w">           </span><span class="c1"># Monitoring the realtime metrics</span>
</span><span id="line-6"><span class="w">    </span>├──<span class="w"> </span>muApp3_monitor.py
</span></code></pre></div>
</div>
</section>
<section id="running-muapp1-downlink-scheduler">
<h4>Running muApp1 - downlink scheduler</h4>
<p><strong>Weight Based abstraction of control</strong> The scheduling logic in <code class="docutils literal notranslate"><span class="pre">srsenb</span></code> is updated to support a weight-based abstraction to allocate the number of RBGs to allocate per UE. A weight-based abstraction allows us to implement any kind of scheduling policy where we provide a weight <code class="docutils literal notranslate"><span class="pre">w_i</span></code> for each UE, the RAN then allocates <code class="docutils literal notranslate"><span class="pre">[w_i*available_rbgs]</span></code> RBGs to each UE.</p>
<p><strong>Terminal 8:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>edgeric
</span><span id="line-2"><span class="nb">cd</span><span class="w"> </span>muApp1
</span><span id="line-3">redis-cli<span class="w"> </span><span class="nb">set</span><span class="w"> </span>scheduling_algorithm<span class="w"> </span><span class="s2">"Max CQI"</span><span class="w"> </span><span class="c1"># setting an initial scheduler</span>
</span><span id="line-4">sudo<span class="w"> </span>python3<span class="w"> </span>muApp1_run_DL_scheduling.py<span class="w"> </span><span class="c1"># sudo not required if you are running in docker</span>
</span></code></pre></div>
</div>
</section>
<section id="setting-the-scheduler-algorithm-manually">
<h4>Setting the scheduler algorithm manually</h4>
<p>Set the scheduling algorithm you want to run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># Line 259</span>
</span><span id="line-2"><span class="nv">selected_algorithm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Max CQI"</span><span class="w">   </span><span class="c1"># selection can be: Max CQI, Max Weight,</span>
</span><span id="line-3"><span class="w">                                 </span><span class="c1"># Proportional Fair (PF), Round Robin</span>
</span><span id="line-4"><span class="w">                                 </span><span class="c1"># RL - models are included for 2 UEs</span>
</span></code></pre></div>
</div>
<p>If the algorithm selected is RL, set the directory for the RL model:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># Line 270</span>
</span><span id="line-2"><span class="nv">rl_model_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Fully Trained Model"</span><span class="w">  </span><span class="c1"># selection can be Initial Model,</span>
</span><span id="line-3"><span class="w">                                       </span><span class="c1"># Half Trained Model, Fully Trained Model - to see benefits, run UE1 with load 5Mbps, UE2 with 21Mbps</span>
</span></code></pre></div>
</div>
<p>The respective models are saved in:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">├──<span class="w"> </span>../rl_model/
</span><span id="line-2"><span class="w">    </span>├──<span class="w"> </span>initial_model
</span><span id="line-3"><span class="w">      </span>├──model_demo.pt
</span><span id="line-4"><span class="w">    </span>├──<span class="w"> </span>half_trained_model
</span><span id="line-5"><span class="w">      </span>├──model_demo.pt
</span><span id="line-6"><span class="w">    </span>├──<span class="w"> </span>fully_trained_model
</span><span id="line-7"><span class="w">      </span>├──model_demo.pt
</span></code></pre></div>
</div>
</section>
<section id="using-redis-to-update-the-scheduling-algorithm">
<h4>Using redis to update the scheduling algorithm</h4>
<p><strong>Terminal 9:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">redis-cli<span class="w"> </span><span class="nb">set</span><span class="w"> </span>scheduling_algorithm<span class="w"> </span><span class="s2">"Max Weight"</span><span class="w"> </span><span class="c1">#selection can be: Max CQI, Max Weight,</span>
</span><span id="line-2"><span class="w">                                                </span><span class="c1"># Proportional Fair (PF), Round Robin</span>
</span><span id="line-3"><span class="w">                                                </span><span class="c1"># RL - models are included for 2 UEs</span>
</span></code></pre></div>
</div>
<p><strong>What to observe</strong></p>
<p><strong>Terminal 3</strong> - srsenb terminal will show the scheduling allocations</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">time: 1722802166592145 rnti: 70 alloc_mask: 1111111000000 # the 1s indicate the PRBs allocated to RNTI 70
</span><span id="line-2">time: 1722802166592178 rnti: 71 alloc_mask: 0000000111111 # the 1s indicate the PRBs allocated to RNTI 71
</span><span id="line-3">time: 1722802168789991 rnti: 71 alloc_mask: 1111110000000
</span><span id="line-4">time: 1722802168790027 rnti: 70 alloc_mask: 0000001111111
</span><span id="line-5">time: 1722802170990251 rnti: 70 alloc_mask: 1111111000000
</span><span id="line-6">time: 1722802170990285 rnti: 71 alloc_mask: 0000000111111
</span><span id="line-7">time: 1722802173211321 rnti: 70 alloc_mask: 1111111000000
</span><span id="line-8">time: 1722802173211351 rnti: 71 alloc_mask: 0000000111111
</span><span id="line-9">time: 1722802175402790 rnti: 71 alloc_mask: 1111110000000
</span><span id="line-10">time: 1722802175402823 rnti: 70 alloc_mask: 0000001111111
</span></code></pre></div>
</div>
<p><strong>Terminal 8</strong> - muApp1 terminal will show the algorithms selected and will print the total average system throughput observed</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">Algorithm index:  2  ,  Max Weight
</span><span id="line-2">total system throughput: 8.781944
</span><span id="line-3">
</span><span id="line-4">Algorithm index:  2  ,  Max Weight
</span><span id="line-5">total system throughput: 8.063600000000001
</span><span id="line-6">
</span><span id="line-7">Algorithm index:  2  ,  Max Weight
</span><span id="line-8">total system throughput: 8.093352
</span><span id="line-9">
</span><span id="line-10">Algorithm index:  2  ,  Max Weight
</span><span id="line-11">total system throughput: 8.071168
</span></code></pre></div>
</div>
<p><strong>Terminal 9</strong> - To observe the throughput updates, let us update the scheduler with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">redis-cli<span class="w"> </span><span class="nb">set</span><span class="w"> </span>scheduling_algorithm<span class="w"> </span><span class="s2">"RL"</span>
</span></code></pre></div>
</div>
<p><strong>Terminal 8</strong> - Increased system throughput observed with our trained RL model</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">Algorithm index:  20  ,  RL
</span><span id="line-2">Executing RL model at: ./rl_model/fully_trained_model
</span><span id="line-3">total system throughput: 12.071200000000001
</span><span id="line-4">
</span><span id="line-5">Algorithm index:  20  ,  RL
</span><span id="line-6">Executing RL model at: ./rl_model/fully_trained_model
</span><span id="line-7">total system throughput: 11.727624
</span><span id="line-8">
</span><span id="line-9">Algorithm index:  20  ,  RL
</span><span id="line-10">Executing RL model at: ./rl_model/fully_trained_model
</span><span id="line-11">total system throughput: 11.714879999999999
</span><span id="line-12">
</span><span id="line-13">Algorithm index:  20  ,  RL
</span><span id="line-14">Executing RL model at: ./rl_model/fully_trained_model
</span><span id="line-15">total system throughput: 11.710384
</span><span id="line-16">
</span><span id="line-17">Algorithm index:  20  ,  RL
</span><span id="line-18">Executing RL model at: ./rl_model/fully_trained_model
</span><span id="line-19">total system throughput: 11.743776
</span></code></pre></div>
</div>
</section>
<section id="running-muapp3-monitoring">
<h4>Running muApp3 - Monitoring</h4>
<p>This muApp will help us see the RT-E2 Report Message from the RAN and the RT-E2 Policy message sent to RAN.</p>
<p><strong>Terminal 10:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>edgeric/muApp3
</span><span id="line-2">python3<span class="w"> </span>muApp3_monitor_terminal.py
</span></code></pre></div>
</div>
<p><strong>What to observe</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">RT-E2 Report:
</span><span id="line-2">
</span><span id="line-3">RAN Index: 791000, RIC index: 790998
</span><span id="line-4">
</span><span id="line-5">UE Dictionary: {70: {'CQI': 7, 'SNR': 115.46858215332031, 'Backlog': 384977, 'Pending Data': 0, 'Tx_brate': 1980.0, 'Rx_brate': 0.0}, 71: {'CQI': 8, 'SNR': 116.41766357421875, 'Backlog': 1503, 'Pending Data': 0, 'Tx_brate': 0.0, 'Rx_brate': 0.0}}
</span><span id="line-6">
</span><span id="line-7">RT-E2 Policy (Scheduling):
</span><span id="line-8">Sent to RAN: ran_index: 790999
</span><span id="line-9">weights: 70.0
</span><span id="line-10">weights: -0.15028022229671478
</span><span id="line-11">weights: 71.0
</span><span id="line-12">weights: 1.150280237197876
</span></code></pre></div>
</div>
</section>
<section id="running-muapp2-training-an-rl-policy-for-scheduling">
<h4>Running muApp2 - Training an RL policy for scheduling</h4>
<img alt="Open AI gym interface" class="align-center" src="_images/training_rl.png"/>
<p>We are training a PPO agent with the objective of throughput maximization in this particular study.</p>
</section>
<section id="usage">
<h4>Usage</h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nb">cd</span><span class="w"> </span>muApp2
</span><span id="line-2">python3<span class="w"> </span>muApp2_train_RL_DL_scheduling.py<span class="w"> </span>--config-name<span class="o">=</span>edge_ric
</span></code></pre></div>
</div>
</section>
<section id="muapp2-train-rl-dl-scheduling-py">
<h4>muApp2_train_RL_DL_scheduling.py</h4>
<ul class="simple">
<li><dl class="simple">
<dt>Trains PPO agent for <code class="docutils literal notranslate"><span class="pre">`num_iters`</span></code> number of iterations</dt><dd><ul>
<li><p>One iteration consists of training on 2048 samples and evaluating for 2048 timesteps</p></li>
<li><p>The evaluation metric (avg reward per episode) is plotted as the training graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputs/</span></code> folder will save the training log, <code class="docutils literal notranslate"><span class="pre">eval_R_avg</span></code> is the metric plotted to visualize the training</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="repo-structure">
<h4>Repo Structure</h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><code><span id="line-1">├──<span class="w"> </span>conf
</span><span id="line-2">│<span class="w">   </span>├──<span class="w"> </span>edge_ric.yaml<span class="w">   </span><span class="c1"># Config file for edgeric RL training</span>
</span><span id="line-3">│<span class="w">   </span>├──<span class="w"> </span>example.yaml
</span><span id="line-4">│<span class="w">   </span>├──<span class="w"> </span>simpler_streaming.yaml
</span><span id="line-5">│<span class="w">   </span>└──<span class="w"> </span>single_agent.yaml
</span><span id="line-6">├──<span class="w"> </span>outputs<span class="w"> </span><span class="c1"># Output logs of each training sorted chronologically</span>
</span><span id="line-7">│<span class="w">   </span>├──<span class="w"> </span><span class="m">2022</span>-10-07
</span><span id="line-8"><span class="w">         </span>├──<span class="w"> </span>model_best.pt<span class="w"> </span><span class="c1"># Saved policy neural network weights</span>
</span><span id="line-9">│<span class="w">          </span>.
</span><span id="line-10">│<span class="w">          </span>.
</span><span id="line-11">│<span class="w">          </span>.
</span><span id="line-12">│
</span><span id="line-13">└──<span class="w"> </span>../stream_rl<span class="w"> </span><span class="c1"># Name of the python package implementing the simulator mechanisms</span>
</span><span id="line-14"><span class="w">    </span>├──<span class="w"> </span>callbacks.py
</span><span id="line-15"><span class="w">    </span>├──<span class="w"> </span>envs<span class="w"> </span><span class="c1"># All the envs</span>
</span><span id="line-16"><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>cqi_traces
</span><span id="line-17"><span class="w">    </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>data.csv<span class="w"> </span><span class="c1"># CQI trace to be used by simulation env</span>
</span><span id="line-18"><span class="w">    </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>trace_generator.py<span class="w"> </span><span class="c1"># Code to generate synthetic CQI traces</span>
</span><span id="line-19"><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>edge_ric.py<span class="w"> </span><span class="c1"># Our Env</span>
</span><span id="line-20"><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>simpler_streaming_env.py
</span><span id="line-21"><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>single_agent_env.py
</span><span id="line-22"><span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>streaming_env.py
</span><span id="line-23"><span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>__init__.py
</span><span id="line-24"><span class="w">    </span>├──<span class="w"> </span>__init__.py
</span><span id="line-25"><span class="w">    </span>├──<span class="w"> </span>plots.py<span class="w"> </span><span class="c1"># All plotting code</span>
</span><span id="line-26"><span class="w">    </span>├──<span class="w"> </span>policy_net<span class="w"> </span><span class="c1"># Custom policy net architectures (not currently used)</span>
</span><span id="line-27"><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>conv_policy.py
</span><span id="line-28"><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>__init__.py
</span><span id="line-29"><span class="w">    </span>├──<span class="w"> </span>registry<span class="w"> </span><span class="c1"># Registry system for registering envs and rewards (to keep things modular)</span>
</span><span id="line-30"><span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>__init__.py
</span><span id="line-31"><span class="w">    </span>└──<span class="w"> </span>rewards.py<span class="w"> </span><span class="c1"># Definition of reward functions to be used in envs</span>
</span></code></pre></div>
</div>
<p>Once the training completes: take the model_best.pt and save in the ../rl_model folder</p>
</section>
<section id="edgeric-env-edge-ric-py">
<h4>EdgeRIC Env (edge_ric.py)</h4>
<ul class="simple">
<li><p>State_space : <code class="docutils literal notranslate"><span class="pre">[BL1,CQI1,BL2,CQI2.....]</span></code> (if augmented_state_space=False)</p></li>
<li><p>Action_space : <code class="docutils literal notranslate"><span class="pre">[Weight1,Weight2.....]</span></code></p></li>
<li><p>Parameters of the env configurable in <code class="docutils literal notranslate"><span class="pre">"./conf/edge_ric.yml"</span></code>, under <code class="docutils literal notranslate"><span class="pre">env_config</span></code> field</p></li>
</ul>
</section>
</section>
</section>
</section>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(100vh-5rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#app-demo-mac-scheduling'" class="reference internal" href="#app-demo-mac-scheduling">μApp demo: MAC scheduling</a></li>
<li><a :data-current="activeSection === '#training-reinforcement-learning-scheduling-policy'" class="reference internal" href="#training-reinforcement-learning-scheduling-policy">Training Reinforcement Learning scheduling Policy</a></li>
<li><a :data-current="activeSection === '#install-srsran-supporting-edgeric-hooks'" class="reference internal" href="#install-srsran-supporting-edgeric-hooks">Install srsRAN supporting EdgeRIC hooks</a><ul>
<li><a :data-current="activeSection === '#option-1-install-on-your-system'" class="reference internal" href="#option-1-install-on-your-system">Option 1: Install on your system</a><ul>
<li><a :data-current="activeSection === '#dependencies-and-cloning-the-repository'" class="reference internal" href="#dependencies-and-cloning-the-repository">Dependencies and cloning the repository</a></li>
<li><a :data-current="activeSection === '#compile-the-protobuf-message-schema'" class="reference internal" href="#compile-the-protobuf-message-schema">Compile the protobuf message schema</a></li>
<li><a :data-current="activeSection === '#build-the-repository'" class="reference internal" href="#build-the-repository">Build the repository</a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#option-2-install-the-containerized-version'" class="reference internal" href="#option-2-install-the-containerized-version">Option 2: Install the containerized version</a><ul>
<li><a :data-current="activeSection === '#building-the-srsran-with-edgeric-support'" class="reference internal" href="#building-the-srsran-with-edgeric-support">Building the srsRAN with EdgeRIC support</a></li>
<li><a :data-current="activeSection === '#how-to-run-the-network'" class="reference internal" href="#how-to-run-the-network">How to run the network</a></li>
<li><a :data-current="activeSection === '#setup-the-core-and-srsenb'" class="reference internal" href="#setup-the-core-and-srsenb">Setup the core and srsenb</a></li>
<li><a :data-current="activeSection === '#run-the-ues'" class="reference internal" href="#run-the-ues">Run the UEs</a></li>
<li><a :data-current="activeSection === '#known-issue'" class="reference internal" href="#known-issue">Known Issue</a></li>
<li><a :data-current="activeSection === '#stream-traffic'" class="reference internal" href="#stream-traffic">Stream Traffic:</a></li>
<li><a :data-current="activeSection === '#running-downlink-iperf-traffic'" class="reference internal" href="#running-downlink-iperf-traffic">Running Downlink iperf traffic</a></li>
<li><a :data-current="activeSection === '#running-edgeric'" class="reference internal" href="#running-edgeric">Running EdgeRIC</a></li>
<li><a :data-current="activeSection === '#edgeric-messenger'" class="reference internal" href="#edgeric-messenger">EdgeRIC messenger</a></li>
<li><a :data-current="activeSection === '#apps-supported-in-this-codebase'" class="reference internal" href="#apps-supported-in-this-codebase">μApps supported in this codebase</a></li>
<li><a :data-current="activeSection === '#running-muapp1-downlink-scheduler'" class="reference internal" href="#running-muapp1-downlink-scheduler">Running muApp1 - downlink scheduler</a></li>
<li><a :data-current="activeSection === '#setting-the-scheduler-algorithm-manually'" class="reference internal" href="#setting-the-scheduler-algorithm-manually">Setting the scheduler algorithm manually</a></li>
<li><a :data-current="activeSection === '#using-redis-to-update-the-scheduling-algorithm'" class="reference internal" href="#using-redis-to-update-the-scheduling-algorithm">Using redis to update the scheduling algorithm</a></li>
<li><a :data-current="activeSection === '#running-muapp3-monitoring'" class="reference internal" href="#running-muapp3-monitoring">Running muApp3 - Monitoring</a></li>
<li><a :data-current="activeSection === '#running-muapp2-training-an-rl-policy-for-scheduling'" class="reference internal" href="#running-muapp2-training-an-rl-policy-for-scheduling">Running muApp2 - Training an RL policy for scheduling</a></li>
<li><a :data-current="activeSection === '#usage'" class="reference internal" href="#usage">Usage</a></li>
<li><a :data-current="activeSection === '#muapp2-train-rl-dl-scheduling-py'" class="reference internal" href="#muapp2-train-rl-dl-scheduling-py">muApp2_train_RL_DL_scheduling.py</a></li>
<li><a :data-current="activeSection === '#repo-structure'" class="reference internal" href="#repo-structure">Repo Structure</a></li>
<li><a :data-current="activeSection === '#edgeric-env-edge-ric-py'" class="reference internal" href="#edgeric-env-edge-ric-py">EdgeRIC Env (edge_ric.py)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© 2024, Ushasi Ghosh Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 8.1.3</a></p>
</div>
</div>
</footer>
</div>
<script src="_static/documentation_options.js?v=34cd777e"></script>
<script src="_static/doctools.js?v=9bcbadda"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script defer="defer" src="_static/theme.js?v=073f68d9"></script>
</body>
</html>